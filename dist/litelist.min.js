/*! litelist 04-05-2014 */

!function(a){if("object"==typeof exports)module.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.LiteList=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){function c(a){this.itemsInView=[],this.items=[],this.itemWidth=a.itemWidth||0,this.itemHeight=a.itemHeight,this.margin=a.margin||{x:0,y:0},this.dataSource=a.dataSource||!1,this.itemTemplate=a.itemTemplate||!1,this.scrollTop=0,this.dirtyResize=!0,this.ticking=!1,this.clientHeight=0,this.clientWidth=0,this.rowsPerPage=0,this.itemsPerRow=0,this.itemsPerPage=0,this.maxBuffer=0,this.view=a.scrollView,this.itemsContainer=a.itemsContainer||!1,this.view="string"==typeof this.view||this.view instanceof String?document.querySelector(this.view):this.view,this.itemsContainer="string"==typeof this.itemsContainer||this.itemsContainer instanceof String?document.querySelector(a.itemsContainer):this.itemsContainer,this._id=0,this._oldStart=0,this._oldEnd=0,this.itemsContainer||(this.itemsContainer=this.view.children[0]),this._ensureVisible=this._ensureVisible.bind(this),this._scrollHandler=this._scrollHandler.bind(this),this._resizeHandler=this._resizeHandler.bind(this),this._calcViewMetrics(),a.delayBind||this.bind(),this.scroll=c.Scroll?new c.Scroll(a.scrollView,this._scrollHandler):!1,this._calcDocHeight(),this._requestTick()}c.prototype._createInViewObj=function(a,b){var c=Math.floor(b/this.itemsPerRow),d=b%this.itemsPerRow,e={id:this._id++,top:c*this.itemHeight+c*this.margin.y,left:d*this.itemWidth+d*this.margin.x,idx:b,item:a};if(this.itemTemplate){var f=this.itemTemplate.cloneNode(!0);f instanceof window.DocumentFragment&&(f=f.childNodes[0]),this.itemsContainer.appendChild(f),e.el=f,this.dataSource&&this.dataSource.bind&&this.dataSource.bind(e.id,f)}return e},c.prototype._calcViewMetrics=function(){this.clientHeight=this.view.clientHeight,this.clientWidth=this.view.clientWidth,this.rowsPerPage=Math.ceil(this.clientHeight/(this.itemHeight+this.margin.y)),this.itemsPerRow=this.itemWidth?Math.floor(this.clientWidth/(this.itemWidth+this.margin.x)):1,this.itemsPerPage=this.rowsPerPage*this.itemsPerRow,this.maxBuffer=3*this.itemsPerPage},c.prototype._calcDocHeight=function(){var a=Math.ceil(this.items.length/this.itemsPerRow),b=a*this.itemHeight+a*this.margin.y;return b!==this.itemsInView.height&&(this.itemsContainer.style.height=b+"px",this.itemsInView.height=b),this.itemsInView.height},c.prototype._positionViewItem=function(a,b){var c=a.idx,d=Math.floor(c/this.itemsPerRow),e=c%this.itemsPerRow,f=d*this.itemHeight+d*this.margin.y,g=e*this.itemWidth+e*this.margin.x;(b||a.top!==f)&&(a.top=f,a.el&&(a.el.style.top=f+"px")),(b||a.left!==g)&&(a.left=g,a.el&&(a.el.style.left=g+"px")),(b||a.item!==this.items[c])&&(a.item=this.items[c],this.dataSource&&this.dataSource.sync&&this.dataSource.sync(a.id,a.el,c,this.items[c]))},c.prototype.__ensureVisible=function(){var a=this.scrollTop/this.itemsInView.height,b=(this.scrollTop+this.clientHeight)/this.itemsInView.height;0>a&&(a=0);var c,d,e,f=Math.floor(a*this.items.length),g=Math.ceil(b*this.items.length);if(this._firstVisibleItem=Math.floor(this.scrollTop/(this.itemHeight+this.margin.y))*this.itemsPerRow,this._lastVisibleItem=Math.ceil((this.scrollTop+this.clientHeight)/(this.itemHeight+this.margin.y))*this.itemsPerRow,this.direction<0){for(c=this._oldEnd;c>g+this.itemsPerRow;--c)d=this.itemsInView[c%this.itemsInView.length],e=c-this.itemsInView.length,e>=0&&(d.idx=e,this._positionViewItem(d));this._oldEnd=c,this._oldStart=Math.max(this._oldEnd-this.itemsInView.length,0)}else{for(c=this._oldStart;c<f-this.itemsPerRow;++c)d=this.itemsInView[c%this.itemsInView.length],e=c+this.itemsInView.length,e<this.items.length&&(d.idx=e,this._positionViewItem(d));this._oldStart=0===c?0:c-1,this._oldEnd=Math.min(this._oldStart+this.itemsInView.length,this.items.length-1)}this.dirtyResize=!1,this.ticking=!1},c.prototype._ensureVisible=function(){if(this.dirtyResize){var a,b,c,d=this.view.clientHeight,e=this.view.clientWidth,f=Math.ceil(d/(this.itemHeight+this.margin.y)),g=this.itemWidth?Math.floor(e/(this.itemWidth+this.margin.x)):1;if(f!==this.rowsPerPage||g!==this.itemsPerRow){if(this._calcViewMetrics(),this._calcDocHeight(),this.itemsInView.length>this.maxBuffer)b=this.itemsInView.splice(0,this.itemsInView.length-this.maxBuffer),this.dataSource&&this.dataSource.unbind&&b.forEach(function(a){this.dataSource.unbind(a.id,a.el),this.itemsContainer.removeChild(a.el)}.bind(this));else if(this.itemsInView.length<this.maxBuffer){var h=[-1,0];for(a=this.itemsInView.length;a<this.maxBuffer;++a)c=this._createInViewObj({},0),h.push(c),this._positionViewItem(c,!0);this.itemsInView.splice.apply(this.itemsInView,h)}for(a=0;a<this.itemsInView.length;++a)this.itemsInView[a].idx=a,this._positionViewItem(this.itemsInView[a]);this._oldStart=0}}this.__ensureVisible()},c.prototype._requestTick=function(){this.ticking||window.requestAnimationFrame(this._ensureVisible),this.ticking=!0},c.prototype.push=function(){var a,b=Array.prototype.slice.call(arguments),c=0,d=this.items.length,e=!1,f=this.itemsLength;for(this.itemsInView.length>=this.maxBuffer&&(f=this.itemsInView.reduce(function(a,b){return a.idx>b.idx?a:b},this.itemsInView[0]||{idx:0}).idx,f===this.items.length-1&&(e=!0)),this.items.push.apply(this.items,b);this.itemsInView.length<this.maxBuffer&&c<b.length;)a=this._createInViewObj(b[c],d),this.itemsInView.push(a),this._positionViewItem(a,!0),c+=1,d+=1;if(e){for(c=0;c<this.itemsInView.length;++c)this.itemsInView[c].idx=c,this._positionViewItem(this.itemsInView[c]);this._oldStart=0}this._calcDocHeight(),this._requestTick()},c.prototype.bind=function(){this.view.addEventListener("scroll",this._scrollHandler),window.addEventListener("resize",this._resizeHandler)},c.prototype.unbind=function(){this.view.removeEventListener("scroll",this._scrollHandler),window.removeEventListener("resize",this._resizeHandler),this.scroll&&this.scroll.unbind()},c.prototype.clear=function(){var a=this.dataSource&&this.dataSource.unbind;this.view.scrollTop=this.scrollTop=0,this._oldStart=this._oldEnd=0,this.itemTemplate&&this.itemsInView.forEach(function(b){b.el&&this.itemsContainer.removeChild(b.el),a&&this.dataSource.unbind(b.id,b.el)}.bind(this)),this.itemsInView.splice(0,Number.MAX_VALUE),this.items.splice(0,Number.MAX_VALUE),this._calcDocHeight()},c.prototype.forEach=function(){return this.items.forEach.apply(arguments)},c.prototype.remove=function(a){var b=!1;if(a>=this.items.length)throw new Error("index out of bounds");if(this.items.splice(a,1),this.itemsInView.forEach(function(c,d){c.idx>=a&&(c.idx>=this.items.length&&(c.idx=c.idx-this.itemsInView.length,c.idx<0&&(c=!1,b=d)),c&&this._positionViewItem(c,!0))},this),b){var c=this.itemsInView[b];this.itemTemplate&&(this.dataSource&&this.dataSource.unbind&&this.dataSource.unbind(c.id,c.el),this.itemsContainer.removeChild(c.el)),this.itemsInView.splice(b,1)}this._calcDocHeight()},c.prototype._scrollHandler=function(){var a=this.view.scrollTop;a!==this.scrollTop&&(this.direction=a>this.scrollTop?1:-1,this.scrollTop=a,this._requestTick())},c.prototype._resizeHandler=function(){this.dirtyResize=!0,this._requestTick()},c.VERSION="0.3.0",b.exports=c},{}]},{},[1])(1)});
//# sourceMappingURL=litelist.min.map